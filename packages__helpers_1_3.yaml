# --- HomeAssistant 1.3 – Helpers (Inputs) ---
# All HA1 helper entities (sliders, toggles, modes) for energy logic.

# --- HA 1.3 Helpers – Global / Master Control ---

input_boolean:
  ha1_automations_master_enable:
    name: "HA1 – Master enable for energy automations"
    icon: mdi:toggle-switch

  # --- HA 1.3 Helpers – Peak Shaving ---
  ha1_peak_shaving_enabled:
    name: "HA1 – Peak shaving enabled"
    icon: mdi:chart-bell-curve

  # These two are per-domain toggles used on the HA1 debug panel and in logic
  ha1_control_ev_auto:
    name: "HA1 – EV automations enabled"
    icon: mdi:ev-plug-type2

  ha1_control_battery_auto:
    name: "HA1 – Battery automations enabled"
    icon: mdi:battery-clock

  ha1_ev_automation_enabled:
    name: "HA1 – EV automations enabled"
    icon: mdi:car-electric

  ha1_battery_automation_enabled:
    name: "HA1 – Battery automations enabled"
    icon: mdi:battery-sync

  # --- HA 1.3 Helpers – Battery ---
  ha1_battery_allow_grid_charge:
    name: "HA1 – Battery: allow grid charging"
    icon: mdi:battery-charging

  ha1_battery_peak_support_enabled:
    name: "HA1 – Battery: peak support enabled"
    icon: mdi:battery-heart-variant

  # --- HA 1.3 Helpers – EV Charging ---
  ha1_ev_obey_peak_limit:
    name: "HA1 – EV: obey peak limit"
    icon: mdi:ev-station

  ha1_force_ev_charge_now:
    name: "HA1 – EV: force charge now"
    icon: mdi:flash

  # --- HA 1.3 Helpers – Comfort & Overrides ---
  ha1_comfort_override_enabled:
    name: "HA1 – Comfort override enabled"
    icon: mdi:account-heart

  ha1_allow_high_price_heating:
    name: "HA1 – Allow high-price heating"
    icon: mdi:fire

  ha1_force_battery_charge_from_grid_now:
    name: "HA1 – Battery: force grid charge now"
    icon: mdi:flash-auto

  # --- HA 1.3 Helpers – Debug & Diagnostics ---
  ha1_debug_energy_logic:
    name: "HA1 – Debug: energy logic"
    icon: mdi:bug

  ha1_debug_notifications_enabled:
    name: "HA1 – Debug: notifications enabled"
    icon: mdi:message-alert

  ha1_debug_freeze_optimizers:
    name: "HA1 – Debug: freeze optimizers"
    icon: mdi:snowflake

  # Debug flag outputs raised by Task 20 scaffolding automations
  ha1_flag_peak_event_active:
    name: "HA1 – Flag: peak event active"
    icon: mdi:flash-alert

  ha1_flag_battery_grid_charge_request:
    name: "HA1 – Flag: battery grid-charge requested"
    icon: mdi:battery-alert

  ha1_flag_battery_peak_reserve_needed:
    name: "HA1 – Flag: battery peak reserve needed"
    icon: mdi:battery-clock

  ha1_flag_ev_charge_window:
    name: "HA1 – Flag: EV charge window open"
    icon: mdi:ev-station

  ha1_flag_ev_peak_block:
    name: "HA1 – Flag: EV blocked by peak"
    icon: mdi:ev-stop

input_number:
  # --- HA 1.3 Helpers – Peak Shaving ---
  ha1_peak_limit_kw:
    name: "HA1 – Peak limit (kW)"
    min: 3
    max: 25
    step: 0.5
    unit_of_measurement: "kW"
    mode: slider
    icon: mdi:flash-alert

  ha1_peak_warning_kw:
    name: "HA1 – Peak warning (kW)"
    min: 0
    max: 25
    step: 0.5
    unit_of_measurement: "kW"
    mode: slider
    icon: mdi:flash-outline

  # --- HA 1.3 Helpers – Battery SOC targets ---
  ha1_battery_min_soc_normal:
    name: "HA1 – Battery min SOC (normal)"
    min: 5
    max: 90
    step: 1
    unit_of_measurement: "%"
    mode: slider
    icon: mdi:battery-70

  # This replaces the old helper from the removed file; it is still referenced
  # in packages/energy_control_1_3.yaml and dashboards/ha1_debug.yaml.
  ha1_batt_peak_shaving_soc:
    name: "HA1 – Battery SOC for peak shaving"
    min: 5
    max: 100
    step: 1
    unit_of_measurement: "%"
    mode: slider
    icon: mdi:battery-80

  ha1_battery_max_soc_target:
    name: "HA1 – Battery max SOC target"
    min: 50
    max: 100
    step: 1
    unit_of_measurement: "%"
    mode: slider
    icon: mdi:battery-90

  # --- HA 1.3 Helpers – Battery grid charging ---
  # Align with Huawei grid charge limit (~2.5 kW) and existing references.
  ha1_batt_grid_charge_max_kw:
    name: "HA1 – Battery: max grid charge (kW)"
    min: 0
    max: 2.5
    step: 0.1
    unit_of_measurement: "kW"
    mode: slider
    icon: mdi:transmission-tower-export

  ha1_battery_grid_charge_limit_kw:
    name: "HA1 – Battery grid charge limit"
    icon: mdi:meter-electric-outline
    unit_of_measurement: "kW"
    mode: box
    min: 0
    max: 2.5
    step: 0.1

  ha1_batt_grid_charge_cutoff_soc:
    name: "HA1 – Battery grid charge cutoff SOC"
    min: 5
    max: 100
    step: 1
    unit_of_measurement: "%"
    mode: slider
    icon: mdi:battery-charging-80

  # --- HA 1.3 Helpers – EV Charging ---
  ha1_ev_max_charging_power_kw:
    name: "HA1 – EV max charging power (kW)"
    min: 0
    max: 16
    step: 0.5
    unit_of_measurement: "kW"
    mode: slider
    icon: mdi:ev-plug-type2

  # This helper is used by Easee/EV scripts to configure allowed current (A).
  ha1_ev_limit_current_a:
    name: "HA1 – EV current limit (A)"
    min: 6
    max: 16
    step: 1
    unit_of_measurement: "A"
    mode: slider
    icon: mdi:current-ac

  # --- HA 1.3 Helpers – EV price thresholds (SEK/kWh) ---
  ha1_ev_price_cheap_max:
    name: "HA1 – EV price: cheap max"
    min: 0
    max: 10
    step: 0.05
    unit_of_measurement: "SEK/kWh"
    mode: slider
    icon: mdi:currency-sek

  ha1_ev_price_normal_max:
    name: "HA1 – EV price: normal max"
    min: 0
    max: 10
    step: 0.05
    unit_of_measurement: "SEK/kWh"
    mode: slider
    icon: mdi:currency-sek

  ha1_ev_price_expensive_max:
    name: "HA1 – EV price: expensive max"
    min: 0
    max: 10
    step: 0.05
    unit_of_measurement: "SEK/kWh"
    mode: slider
    icon: mdi:currency-sek

input_select:
  # --- HA 1.3 Helpers – EV Charging ---
  ha1_ev_charging_mode:
    name: "HA1 – EV charging mode"
    options:
      - "off"
      - "cheap_only"
      - "balanced"
      - "aggressive"
      - "manual"
    icon: mdi:ev-station
